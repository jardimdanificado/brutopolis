<html>
    <head>
        <title>Draw on html canvas</title>
    </head>
    <body>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.2/p5.min.js" integrity="sha512-eu9vkh+EbAsW3fMmPTj/DP5W3UegIdu0Z/OABMocvoofx43MYBkcQ9hRIVxZndV1vcCYQwBg+U1PkWl04TD0Jg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <script src='lib/fengari-web.js' type="text/javascript"></script>
        <script type="text/javascript">
            async function main()
            {
                //brutopolis code
                //let code = await fetch("main.lua").then(response => response.text());
                //fengari.load(code)();
                
                /*fengari.load(`
                    local js = require "js"
                    local window = js.global
                    local document = window.document
                    window.bruter = br
                `)()*/

                fengari.load(`
                    local js = require "js"
                    local window = js.global
                    local document = window.document

                    function window.setup()
                        window:createCanvas(400, 400)
                    end
                    
                    function window.draw()
                        window:background(220)
                        window:fill(255, 0, 0)
                        window:ellipse(200, 200, 50, 50)
                    end`)()
                
                setup = window.setup
                draw = window.draw
                console.log(window.bruter)
            }
            main()
        </script>
    </body>
</html>